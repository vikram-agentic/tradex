ğŸš€ TRADEX AI - DEPLOYMENT CHECKLIST
=====================================

âœ… COMPLETED:
- [x] Frontend code built and running
- [x] Supabase Edge Functions deployed (agent-decision, execute-trade, agent-scheduler)
- [x] Database migrations applied
- [x] Real-time WebSocket connections working

ğŸ”§ REQUIRED CONFIGURATION:

1. SET SUPABASE SECRETS (CRITICAL!)
   Run these commands in your terminal:

   npx supabase secrets set API_KEY_ENCRYPTION_SECRET=your-random-32-char-secret

   Example:
   npx supabase secrets set API_KEY_ENCRYPTION_SECRET=MySuper$ecretKey123456789012345

   âš ï¸ This MUST be set or API key encryption will fail!

2. ADD YOUR API KEYS IN THE APP
   a) Go to Settings page in the app
   b) Add your Anthropic API key (starts with sk-ant-...)
   c) Add your Alpaca Paper Trading keys (get from alpaca.markets)

   If you get "409 Conflict" error:
   - The key already exists
   - Delete it first from Settings, then re-add
   - OR use the manage-api-keys function to update

3. RUN THE MIGRATION FOR ENCRYPTION
   - Go to Supabase Dashboard â†’ SQL Editor
   - Run the migration file:
     supabase/migrations/20251104130000_add_encryption_and_performance_tracking.sql

   This adds the decrypt_api_key() function

4. TEST THE SETUP
   - Create an agent in the dashboard
   - Click "Start" button
   - Watch browser console for logs
   - Should see: "ğŸ¤– Agent Name: Starting trading cycle..."

ğŸ¯ HOW IT WORKS:

1. When you click "Start" on an agent:
   â†’ AutopilotTrading component activates
   â†’ Runs trading cycle every 30 seconds

2. Each cycle:
   â†’ Fetches mock market data
   â†’ Calls agent-decision function
   â†’ Claude analyzes and decides (BUY/SELL/HOLD)
   â†’ If BUY/SELL with >70% confidence â†’ Executes trade
   â†’ Updates dashboard in real-time

3. Your API keys are:
   â†’ Encrypted in database using pgcrypto
   â†’ Decrypted server-side only
   â†’ Never exposed to browser

ğŸ› TROUBLESHOOTING:

ERROR: "500 Internal Server Error" from agent-decision
FIX:
- Check Supabase Dashboard â†’ Edge Functions â†’ Logs
- Likely cause: Anthropic API key not added in Settings
- OR encryption secret not set in Supabase

ERROR: "409 Conflict" when adding API key
FIX:
- API key already exists for that service
- Go to Settings â†’ Delete the existing key â†’ Re-add

ERROR: "Failed to decrypt API key"
FIX:
- Run: npx supabase secrets set API_KEY_ENCRYPTION_SECRET=your-secret
- Make sure migration with decrypt_api_key() function is applied

ERROR: Agent not trading automatically
FIX:
- Check agent status is "active" (not paused)
- Open browser console â†’ Should see trading cycle logs
- Check Anthropic API key is valid

ğŸ‰ ONCE WORKING:

You'll see:
- ğŸ¤– Agent Name: Starting trading cycle... (every 30 seconds)
- ğŸ§  Agent Name: Asking Claude for trading decision...
- ğŸ’¡ Agent Name Decision: BUY/SELL/HOLD
- ğŸ“ˆ Agent Name: Executing BUY trade for AAPL
- âœ… Agent Name: Trade executed successfully!

Real-time updates:
- Activity feed shows all trades
- Leaderboard updates automatically
- Agent cards show live balance/profit
- Notifications appear for trades

ğŸš€ YOU'RE ALL SET!

The app is now a FULLY AUTONOMOUS TRADING PLATFORM where:
- Multiple AI agents trade 24/7
- Each agent uses Claude AI for decisions
- Agents compete on the leaderboard
- All trades happen automatically
- Real-time updates everywhere

IMPORTANT: Start with paper trading only! Test thoroughly before using real money.
